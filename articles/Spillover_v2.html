<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spillover, compensation, Transformations, and Visualization • CytoverseBioc2023</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Spillover, compensation, Transformations, and Visualization">
<meta property="og:description" content="CytoverseBioc2023">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CytoverseBioc2023</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9005</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Bioc2023_Cytoverse.html">Reproducible and programmatic analysis of flow cytometry experiments with the cytoverse</a>
    </li>
    <li>
      <a href="../articles/Gating_1.html">Gating Cells in cytoverse</a>
    </li>
    <li>
      <a href="../articles/HOWTO_BUILD_WORKSHOP.html">How To Build A Workshop Package</a>
    </li>
    <li>
      <a href="../articles/Import_fcs.html">Importing and Basics of working with FCS files</a>
    </li>
    <li>
      <a href="../articles/Reporting_1.html">Reporting: Counts, Frequency, etc</a>
    </li>
    <li>
      <a href="../articles/Spillover_v2.html">Spillover, compensation, Transformations, and Visualization</a>
    </li>
    <li>
      <a href="../articles/ggcyto_1-5.html">Visualization (1.5)</a>
    </li>
    <li>
      <a href="../articles/workshop_example.html">An Example Workshop</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/OzetteTech/cytoverse-bioc-2023" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Spillover, compensation, Transformations, and
Visualization</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/OzetteTech/cytoverse-bioc-2023/blob/HEAD/vignettes/Spillover_v2.Rmd" class="external-link"><code>vignettes/Spillover_v2.Rmd</code></a></small>
      <div class="hidden name"><code>Spillover_v2.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>In this section, we aim to clarify the concept of Spillover, and the
use of spillover/compensation matrices to correct for this. The last
part of this section will deal with various transformations of the
underlying expression data.</p>
<div class="section level3">
<h3 id="spillover">Spillover<a class="anchor" aria-label="anchor" href="#spillover"></a>
</h3>
<p>[CLARIFY THIS FURTHER] Flow cytometers (optics based: spectral or
non-spectral) collect fluorescent signal from a cell as result of a
laser excitation. Briefly, cell type C has been labelled with a marker M
that is conjugated to a fluorophore (F). F has the property that it is
excitation maxima at certain wavelength (W) resulting in fluoroscence.
While the fluoresence has a emmision maxima, the emission profile of F
can span many nanometers. The cytometer has a dedicated detector
(channel) A to detect peak emission of F. However, due to the spread of
the emission of F, some signal from F is also “spilled” onto detector B,
a detector for a different fluorophore.</p>
<p>The image below provides a concrete example.</p>
<div class="figure">
<img src="https://static.bio-rad-antibodies.com/2016/flow-cytometry/fig-9-spectral-profiles.png" alt=""><p class="caption">Excitation/Emission spectra for FITC. Taken from
Bio-Rad. A is the dedicated detector for FITC. B is a secondary detector
where FITC signal spills over.</p>
</div>
<p>The “spillover” of signal onto secondary detector(s) is additive and
can be easily recovered (more on this below).</p>
<p>Raw Signal in B = Signal from FITC (spillover) + Signal for a
dedicated fluorophore.</p>
<p>Signal recovery (Compensation) requires a set of controls be present
to calculate the spillover. These controls are called <strong>Single
Colour Controls</strong> and are often acquired prior to sample
acquisition. The purpose of the single colour control is to estimate the
amount of spillover of emission from fluorophore F onto non-primary
detectors (detector B in the image above).</p>
<p>[TO ADD INFORMATION ABOUT SPECTRAL] Note: ABOUT Spectral instruments
are set up slightly differently…</p>
</div>
<div class="section level3">
<h3 id="importance-of-spillover-correction">Importance of spillover correction<a class="anchor" aria-label="anchor" href="#importance-of-spillover-correction"></a>
</h3>
<p>Let’s visualize the data to highlight the main issues related to
spillover. We will make use of the <code>ggcyto</code> library from the
<code>cytoverse</code> for this. We will dive into more details on the
usage of <code>ggcyto</code> in a later section.</p>
<p><img src="Spillover_v2_files/figure-html/viz_uncompensated_data-1.png" width="960"></p>
<p>Another example:</p>
<p><img src="Spillover_v2_files/figure-html/uncompensated_data_issue-1.png" width="960"></p>
<p>In example 1,the plot first plot shows the uncompensated data. In
this example, the 2 fluorophores: PE-Cy5 and PE-Cy5.5 are spilling onto
each other, making the data not resolvable. However, after correcting
for spillover, we see that the data can be resolved (2nd plot).</p>
<p>In example 2, we see a population of events that are positive of
marker: Live Dead UV Blue. Generally, these events are discarded as this
marker is used to identify dead cells. However, in correctly compensated
data, we see that this population does not exist!</p>
</div>
<div class="section level3">
<h3 id="where-to-find-your-spillover-matrix">Where to find your spillover matrix?<a class="anchor" aria-label="anchor" href="#where-to-find-your-spillover-matrix"></a>
</h3>
<p>In many cases, the spillover matrix (which is used to correct the
spillover) is attached to the FCS files within
<code>$SPILLOVER</code>,<code>SPILL</code>,or <code>SPILL</code>
keywords. In <code>cytoverse</code>, we can check for the presence of by
using the function <code>spillover(ff)</code>.</p>
<p>Example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># show spillover</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html" class="external-link">spillover</a></span><span class="op">(</span><span class="va">ff</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $SPILL</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $spillover</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`$SPILLOVER`</span></span>
<span><span class="co">##              B515-A        B610-A        B660-A        B710-A        B780-A</span></span>
<span><span class="co">##  [1,]  1.0000000000  0.0654894460  0.0356302035  0.0029254752  0.0008449831</span></span>
<span><span class="co">##  [2,]  0.0093862808  1.0000000000  0.7882951056  0.0745542215  0.0250840047</span></span>
<span><span class="co">##  [3,]  0.0054477562  0.0308300643  1.0000000000  0.1125626913  0.0374552874</span></span>
<span><span class="co">##  [4,]  0.0232877053  0.1173532702  0.8955441539  1.0000000000  0.4274273094</span></span>
<span><span class="co">##  [5,]  0.0263317480  0.0866490000  0.1599768604  0.0324309609  1.0000000000</span></span>
<span><span class="co">##  [6,]  0.0029226586  0.3956117744  0.2698294289  0.0235842703  0.0060479979</span></span>
<span><span class="co">##  [7,]  0.0023861688  0.9153572517  0.7085405010  0.0775836676  0.0241986406</span></span>
<span><span class="co">##  [8,]  0.0014122317  0.0155860369  1.6380846002  0.2707078172  0.0949168290</span></span>
<span><span class="co">##  [9,]  0.0012543619  0.0146942070  0.1237795271  0.3159420000  0.1320410000</span></span>
<span><span class="co">## [10,]  0.0030060073  0.0142997906  0.0119625555  0.0053839156  1.0067100000</span></span>
<span><span class="co">## [11,] -0.0002186754  0.0003868355  0.0793509345  0.0076994793  0.0027485207</span></span>
<span><span class="co">## [12,]  0.0006298100  0.0001181542  0.0072717422  0.0232312763  0.0083635498</span></span>
<span><span class="co">## [13,]  0.0006324496  0.0002277156  0.0023505209  0.0004356428  0.0450062282</span></span>
<span><span class="co">## [14,]  0.0000371600 -0.0000037269  0.0000402270  0.0000067503 -0.0000205130</span></span>
<span><span class="co">## [15,]  0.0152840902  0.0007469344 -0.0000655014  0.0002516557 -0.0000242346</span></span>
<span><span class="co">## [16,]  0.0698186812  0.0050055112  0.0032244478  0.0002924284  0.0000892089</span></span>
<span><span class="co">## [17,]  0.0018094627  0.1801790047  0.1086006366  0.0092703868  0.0025147988</span></span>
<span><span class="co">## [18,]  0.0007380500  0.0021129984  0.0928220000  0.0178822285  0.0053203495</span></span>
<span><span class="co">## [19,]  0.0001832170  0.0001874975  0.0017087346  0.0910590886  0.1396358857</span></span>
<span><span class="co">## [20,]  0.0001161554  0.0015137962  0.0013928872  0.0002876104  0.0207331506</span></span>
<span><span class="co">## [21,]  0.0000259284  0.0000026205  0.0000046004 -0.0000024305 -0.0000094620</span></span>
<span><span class="co">## [22,]  0.0024755568  0.0007875071  0.0009465724  0.0001304997 -0.0000651446</span></span>
<span><span class="co">## [23,] -0.0000664517  0.0979500000  0.0837278085  0.0082513490  0.0025234889</span></span>
<span><span class="co">## [24,]  0.0002543497  0.2477079125  0.2676769930  0.0295185107  0.0107736937</span></span>
<span><span class="co">## [25,]  0.0000000000  0.0047715344  0.0760284035  0.0092458021  0.0027141047</span></span>
<span><span class="co">## [26,]  0.0001085469  0.0000958875  0.0071224283  0.0700000000  0.0516751244</span></span>
<span><span class="co">## [27,]  0.0001024194  0.0003073189  0.0003971912  0.0084841674  0.0821751638</span></span>
<span><span class="co">## [28,]  0.0001011734  0.0002092628  0.0003642644  0.0002839300  0.0300000000</span></span>
<span><span class="co">##             G575-A       G610-A        G660-A       G710-A        G780-A</span></span>
<span><span class="co">##  [1,] 0.0082839158 0.0028790182  0.0008539079 0.0003357982  0.0000336139</span></span>
<span><span class="co">##  [2,] 0.0252292729 0.4906020000  0.1845662022 0.0728974850  0.0076792734</span></span>
<span><span class="co">##  [3,] 0.0023043205 0.0037468212  0.1752600000 0.0797172871  0.0091302494</span></span>
<span><span class="co">##  [4,] 0.0105695634 0.0118602859  0.1227136768 0.7772650000  0.1191710000</span></span>
<span><span class="co">##  [5,] 0.0257745563 0.0265636944  0.0229724955 0.0240359137  0.2646130000</span></span>
<span><span class="co">##  [6,] 1.0000000000 0.3515799708  0.1353662458 0.0533091593  0.0051051806</span></span>
<span><span class="co">##  [7,] 0.1808211022 1.0000000000  0.4300340000 0.2069533275  0.0227258875</span></span>
<span><span class="co">##  [8,] 0.0731262317 0.0285733034  1.0000000000 0.8105253391  0.1024470712</span></span>
<span><span class="co">##  [9,] 0.0682671508 0.0254464529  0.0855404863 1.0000000000  0.1499063932</span></span>
<span><span class="co">## [10,] 0.0857184693 0.0348000639  0.0147374155 0.0269637133  1.0000000000</span></span>
<span><span class="co">## [11,] 0.0001027807 0.0045671664  0.4195790000 0.1924994215  0.0267805730</span></span>
<span><span class="co">## [12,] 0.0000728624 0.0004081205  0.0205041810 0.2815082716  0.0375776427</span></span>
<span><span class="co">## [13,] 0.0004644973 0.0007327559  0.0122034141 0.0096435857  0.2780472618</span></span>
<span><span class="co">## [14,] 0.0000370925 0.0000342040  0.0000472205 0.0000453873  0.0000091818</span></span>
<span><span class="co">## [15,] 0.0087818949 0.0031007530  0.0011377035 0.0008283278  0.0002096875</span></span>
<span><span class="co">## [16,] 0.0002804399 0.0001885965  0.0000745089 0.0001090675  0.0000188601</span></span>
<span><span class="co">## [17,] 1.8494699136 0.7346175460  0.2466528393 0.0922051963  0.0092241886</span></span>
<span><span class="co">## [18,] 0.0010152936 0.0135096316  0.4976860000 0.2729318069  0.0296728547</span></span>
<span><span class="co">## [19,] 0.0003248848 0.0003437068  0.0005400292 0.0399725963  0.0208155392</span></span>
<span><span class="co">## [20,] 0.0019391802 0.0028833039  0.0014587076 0.0013805414  0.0254227914</span></span>
<span><span class="co">## [21,] 0.0000070914 0.0000032455 -0.0000066467 0.0000052504  0.0000021341</span></span>
<span><span class="co">## [22,] 0.0001826569 0.0000825645  0.0000092462 0.0001495319 -0.0000116460</span></span>
<span><span class="co">## [23,] 0.5641670000 0.2911900000  0.1344737692 0.0589841904  0.0066485143</span></span>
<span><span class="co">## [24,] 0.1838817631 1.1084860000  0.7282579556 0.3572482021  0.0469262690</span></span>
<span><span class="co">## [25,] 0.0026408394 0.0292224009  0.2607304382 0.1420003758  0.0158387599</span></span>
<span><span class="co">## [26,] 0.0001328083 0.0001273373  0.0020128687 0.0848199753  0.0160702874</span></span>
<span><span class="co">## [27,] 0.0002398960 0.0002263868  0.0001773840 0.0092101315  0.0254895948</span></span>
<span><span class="co">## [28,] 0.0002269509 0.0002754166  0.0003101643 0.0017780329  0.0463526169</span></span>
<span><span class="co">##              R670-A        R730-A       R780-A        U390-A        U450-A</span></span>
<span><span class="co">##  [1,] -0.0000063305  0.0000084621 0.0000000000  0.0000446083  0.0000159830</span></span>
<span><span class="co">##  [2,]  0.0081509961  0.0046717692 0.0004831082  0.0000000000 -0.0000039389</span></span>
<span><span class="co">##  [3,]  0.2613130000  0.1647444481 0.0165117267  0.0000000000  0.0000140163</span></span>
<span><span class="co">##  [4,]  0.1643668782  0.7351185260 0.1132544960  0.0000304994  0.0000109278</span></span>
<span><span class="co">##  [5,]  0.0007803282  0.0164450922 0.0651700000  0.0000000000 -0.0000622848</span></span>
<span><span class="co">##  [6,]  0.0001831487  0.0002075091 0.0000077461  0.0000000000  0.0000298887</span></span>
<span><span class="co">##  [7,]  0.0045593367  0.0032172664 0.0003826008  0.0000159905 -0.0000113539</span></span>
<span><span class="co">##  [8,]  0.1828690000  0.1497340000 0.0155379084  0.0000000000  0.0000065421</span></span>
<span><span class="co">##  [9,]  0.0166056334  0.1397122725 0.0211950581  0.0000296768  0.0000053089</span></span>
<span><span class="co">## [10,]  0.0003457433  0.0131970792 0.0613852390  0.0000220811 -0.0000195688</span></span>
<span><span class="co">## [11,]  1.0000000000  0.6746970000 0.0672186896  0.0000717944 -0.0000255661</span></span>
<span><span class="co">## [12,]  0.0677030567  1.0000000000 0.1024304806  0.0000177877 -0.0000031719</span></span>
<span><span class="co">## [13,]  0.0395138625  0.1729764753 1.0000000000  0.0008962927  0.0000219476</span></span>
<span><span class="co">## [14,]  0.0000260464  0.0000183553 0.0000000000  1.0000000000  0.0715668942</span></span>
<span><span class="co">## [15,]  0.0000903667  0.0004302125 0.0000355452  1.6375342268  1.0000000000</span></span>
<span><span class="co">## [16,]  0.0000000000  0.0000227529 0.0000000000  0.0680929018  0.0601659197</span></span>
<span><span class="co">## [17,]  0.0000548722  0.0000588240 0.0000000000  0.1123320000  0.0084416026</span></span>
<span><span class="co">## [18,]  0.9535728348  0.7421256270 0.0748409002  0.0662397445  0.0116252447</span></span>
<span><span class="co">## [19,]  0.0026718912  0.7261888317 0.1267611796  0.0676552190  0.0113170554</span></span>
<span><span class="co">## [20,]  0.0005431531  0.0096017096 0.1544340070  0.2960000000  0.0493877222</span></span>
<span><span class="co">## [21,]  0.0000072480 -0.0000032586 0.0000000000  0.0002074509  0.0199387823</span></span>
<span><span class="co">## [22,]  0.0000996095  0.0000000000 0.0000000000 -0.0001386642  0.0275791593</span></span>
<span><span class="co">## [23,]  0.0002409273  0.0001752918 0.0000000000 -0.0001945789  0.0018937711</span></span>
<span><span class="co">## [24,]  0.0139532270  0.0108588675 0.0012493952  0.0000827472  0.0019518068</span></span>
<span><span class="co">## [25,]  0.4010171690  0.3095665279 0.0327516235 -0.0001235885  0.0020041568</span></span>
<span><span class="co">## [26,]  0.0204302418  0.9997730000 0.1222550376 -0.0001052901  0.0016909975</span></span>
<span><span class="co">## [27,]  0.0001340774  0.1392279331 0.0682937436 -0.0000683812  0.0006855189</span></span>
<span><span class="co">## [28,]  0.0005405149  0.0151929227 0.0494363782 -0.0000328085  0.0009994182</span></span>
<span><span class="co">##              U500-A        U570-A       U660-A       U740-A       U785-A</span></span>
<span><span class="co">##  [1,]  0.0235917813  0.0061384441 0.0004102750 0.0000773913 0.0000000000</span></span>
<span><span class="co">##  [2,]  0.0003203807  0.0052602974 0.0249692722 0.0058028052 0.0017509891</span></span>
<span><span class="co">##  [3,]  0.0001879891  0.0010441665 0.0318492556 0.0104707662 0.0030321952</span></span>
<span><span class="co">##  [4,]  0.0008401743  0.0043630052 0.0266911262 0.0706590000 0.0403032888</span></span>
<span><span class="co">##  [5,]  0.0008370850  0.0057473994 0.0038369048 0.0204155733 0.1335024236</span></span>
<span><span class="co">##  [6,]  0.0001610826  0.0829439007 0.0112098217 0.0017331871 0.0005784301</span></span>
<span><span class="co">##  [7,] -0.0000224251  0.0059834211 0.0176930000 0.0057936405 0.0019580358</span></span>
<span><span class="co">##  [8,]  0.0000322542  0.0010624577 0.0338630000 0.0202256964 0.0052461463</span></span>
<span><span class="co">##  [9,]  0.0000209065  0.0011503056 0.0027375114 0.0163066622 0.0085663395</span></span>
<span><span class="co">## [10,] -0.0000309667  0.0007702062 0.0001189082 0.0096545484 0.0757493500</span></span>
<span><span class="co">## [11,] -0.0001006848 -0.0000506688 0.0490000000 0.0254567771 0.0055693489</span></span>
<span><span class="co">## [12,]  0.0000250980 -0.0000062958 0.0026131953 0.0249920000 0.0086412505</span></span>
<span><span class="co">## [13,]  0.0005225758  0.0000000000 0.0011782568 0.0113432961 0.1187953605</span></span>
<span><span class="co">## [14,]  0.0958982944  0.0067529414 0.0004387057 0.0001325069 0.0000251467</span></span>
<span><span class="co">## [15,]  1.5135519893  0.1383666752 0.0169096199 0.0067897017 0.0032852189</span></span>
<span><span class="co">## [16,]  1.0000000000  0.1664025713 0.0138239208 0.0029111888 0.0009098811</span></span>
<span><span class="co">## [17,]  0.0131786211  1.0000000000 0.0957280252 0.0171014040 0.0055378535</span></span>
<span><span class="co">## [18,]  0.0193760773  0.0026755322 1.0000000000 0.3582442013 0.1021335267</span></span>
<span><span class="co">## [19,]  0.0181141497  0.0018046653 0.0021976061 1.0000000000 0.3123709707</span></span>
<span><span class="co">## [20,]  0.0768280802  0.0083181330 0.0014921176 0.0211529136 1.0000000000</span></span>
<span><span class="co">## [21,]  0.0330780901  0.0026794268 0.0001224306 0.0000282899 0.0000000000</span></span>
<span><span class="co">## [22,]  0.4062437424  0.1580000000 0.0317046513 0.0096792138 0.0034038893</span></span>
<span><span class="co">## [23,]  0.0034116521  0.1358300000 0.0334930036 0.0076754942 0.0025117156</span></span>
<span><span class="co">## [24,]  0.0034847779  0.0773736550 0.2421230000 0.0818191394 0.0276059349</span></span>
<span><span class="co">## [25,]  0.0034069479  0.0010978286 0.3356809153 0.0968081821 0.0300679041</span></span>
<span><span class="co">## [26,]  0.0031418821  0.0004126759 0.0066743089 0.2965810109 0.1233777513</span></span>
<span><span class="co">## [27,]  0.0013164596  0.0004805398 0.0001831665 0.2295597332 0.1583617556</span></span>
<span><span class="co">## [28,]  0.0020677066  0.0003846433 0.0003070539 0.0304262084 0.1703870000</span></span>
<span><span class="co">##              V450-A        V510-A       V570-A        V605-A       V655-A</span></span>
<span><span class="co">##  [1,]  0.0001126169  0.0244469354 0.0133239975  0.0017077163 0.0006419635</span></span>
<span><span class="co">##  [2,] -0.0000554311  0.0013903555 0.0237150000  0.1137803713 0.0791702484</span></span>
<span><span class="co">##  [3,] -0.0000325252  0.0008273251 0.0082851408  0.0039091379 0.1212970000</span></span>
<span><span class="co">##  [4,] -0.0000383267  0.0034433249 0.0352893754  0.0149409056 0.0874069877</span></span>
<span><span class="co">##  [5,] -0.0001771661  0.0029766981 0.0337066863  0.0126301738 0.0130122234</span></span>
<span><span class="co">##  [6,] -0.0000615977 -0.0000685174 0.2265353728  0.0432247652 0.0166494501</span></span>
<span><span class="co">##  [7,] -0.0000401281 -0.0000110945 0.0108360339  0.0412987185 0.0296288722</span></span>
<span><span class="co">##  [8,] -0.0000228412 -0.0000063151 0.0026596753  0.0005125683 0.0551460000</span></span>
<span><span class="co">##  [9,]  0.0000000000  0.0000206532 0.0029179225  0.0005357699 0.0035614167</span></span>
<span><span class="co">## [10,] -0.0001104826 -0.0000305945 0.0019596098  0.0003289707 0.0001785058</span></span>
<span><span class="co">## [11,]  0.0000000000  0.0000499562 0.0000000000  0.0002176366 0.0617797375</span></span>
<span><span class="co">## [12,]  0.0000449063  0.0000748374 0.0000000000  0.0000143900 0.0026653617</span></span>
<span><span class="co">## [13,]  0.0016213806  0.0002739234 0.0000522934 -0.0000418152 0.0014001869</span></span>
<span><span class="co">## [14,]  0.0028495698  0.0005212159 0.0001460806  0.0000029026 0.0000084195</span></span>
<span><span class="co">## [15,]  0.5534992576  0.0641345305 0.0074114867  0.0008045019 0.0005984415</span></span>
<span><span class="co">## [16,]  0.0162614522  0.1950370000 0.0514698507  0.0069806590 0.0024811015</span></span>
<span><span class="co">## [17,]  0.0006973093  0.0002682714 0.0664240134  0.0103207046 0.0038262242</span></span>
<span><span class="co">## [18,]  0.0010439705  0.0003932483 0.0003280923  0.0008245414 0.0906160000</span></span>
<span><span class="co">## [19,]  0.0009210165  0.0002829874 0.0001068950  0.0000071344 0.0001537055</span></span>
<span><span class="co">## [20,]  0.0041824407  0.0011299998 0.0004103352  0.0000548546 0.0000664001</span></span>
<span><span class="co">## [21,]  1.0000000000  0.0994629766 0.0149634907  0.0015441998 0.0004792632</span></span>
<span><span class="co">## [22,]  0.1943348870  1.0000000000 0.7638979136  0.1500932160 0.0797061038</span></span>
<span><span class="co">## [23,]  0.2081230000  0.0211239114 1.0000000000  0.2341494800 0.1224183543</span></span>
<span><span class="co">## [24,]  0.2156768802  0.0220420896 0.2084451885  1.0000000000 0.7719972989</span></span>
<span><span class="co">## [25,]  0.1939906460  0.0208337609 0.0068534717  0.0470037792 1.0000000000</span></span>
<span><span class="co">## [26,]  0.1845147305  0.0203733765 0.0048240293  0.0007441674 0.0196061776</span></span>
<span><span class="co">## [27,]  0.0933951231  0.0100299903 0.0042920248  0.0009033967 0.0009307708</span></span>
<span><span class="co">## [28,]  0.1016800000  0.0125135507 0.0036818403  0.0007662927 0.0013439907</span></span>
<span><span class="co">##             V710-A       V750-A       V785-A</span></span>
<span><span class="co">##  [1,] 0.0002971922 0.0001257152 0.0000583097</span></span>
<span><span class="co">##  [2,] 0.0366353688 0.0160234558 0.0100516039</span></span>
<span><span class="co">##  [3,] 0.0720700000 0.0269798099 0.0154732634</span></span>
<span><span class="co">##  [4,] 0.5207322077 0.2159840000 0.1798193819</span></span>
<span><span class="co">##  [5,] 0.0128252630 0.1001290000 0.5813326554</span></span>
<span><span class="co">##  [6,] 0.0071923334 0.0023822001 0.0013819583</span></span>
<span><span class="co">##  [7,] 0.0162058919 0.0063538387 0.0038768631</span></span>
<span><span class="co">##  [8,] 0.0409619444 0.0224142160 0.0110338571</span></span>
<span><span class="co">##  [9,] 0.0467728361 0.0188471465 0.0165369398</span></span>
<span><span class="co">## [10,] 0.0005046499 0.0316497285 0.1558437227</span></span>
<span><span class="co">## [11,] 0.0289495267 0.0206439009 0.0095696913</span></span>
<span><span class="co">## [12,] 0.0360590000 0.0401390000 0.0263410000</span></span>
<span><span class="co">## [13,] 0.0009976876 0.0329562787 0.2253836760</span></span>
<span><span class="co">## [14,] 0.0000217317 0.0000170133 0.0000019936</span></span>
<span><span class="co">## [15,] 0.0004410047 0.0004482531 0.0003501377</span></span>
<span><span class="co">## [16,] 0.0010815226 0.0004720806 0.0002951247</span></span>
<span><span class="co">## [17,] 0.0016619655 0.0005979447 0.0003571689</span></span>
<span><span class="co">## [18,] 0.0515933368 0.0234699167 0.0132197184</span></span>
<span><span class="co">## [19,] 0.0232060595 0.0690649491 0.0393457654</span></span>
<span><span class="co">## [20,] 0.0000580466 0.0027328942 0.1055924723</span></span>
<span><span class="co">## [21,] 0.0002364643 0.0001253462 0.0001236473</span></span>
<span><span class="co">## [22,] 0.0461123165 0.0222024133 0.0157047765</span></span>
<span><span class="co">## [23,] 0.0597285658 0.0249064740 0.0157728879</span></span>
<span><span class="co">## [24,] 0.4081358956 0.2031510119 0.1297043514</span></span>
<span><span class="co">## [25,] 0.5812987029 0.2329972275 0.1391381582</span></span>
<span><span class="co">## [26,] 1.0000000000 0.6294465489 0.5085686408</span></span>
<span><span class="co">## [27,] 0.0899398069 1.0000000000 0.8329581697</span></span>
<span><span class="co">## [28,] 0.0063802415 0.2152920000 1.0000000000</span></span></code></pre>
<p>We notice a few important details. - <code>spillover(ff)</code>
returns all 3 keywords, even if some do not contain a matrix - It is not
necessary that all 3 keywords have a matrix - spillover matrix is
square. This is because the user will run 1 single colour control for
each channel/marker they intend to acquire. In this example its 28 x
28</p>
<p>The columns of the spillover matrix are the detectors while the rows
are contribution from each fluorophore. Visualizing it as a heatmap is
sometimes more helpful</p>
<p><img src="Spillover_v2_files/figure-html/explain_spillover-1.png" width="960"></p>
<p>Looking at the figure, column 2: B610-A has high spillover from
flurophore: PE-Dazzle594 and PE.</p>
<p>In fact, when we look at the emission spectrum of the 2 dyes we see
that this issue is apparent:</p>
<p><img src="images/spectrumChart.png" alt="Spectra from PE and BB630P2."> The image was created at <a href="https://www.bdbiosciences.com/en-ca/resources/bd-spectrum-viewer" class="external-link uri">https://www.bdbiosciences.com/en-ca/resources/bd-spectrum-viewer</a>
using the BD spectrum viewer tool.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Andrew McDavid, Arpan Neupan.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
